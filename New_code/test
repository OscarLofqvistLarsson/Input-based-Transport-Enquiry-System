from connection import *

def populate_tables():
    INSERT_PEOPLE = """
        INSERT INTO people (fname, funds)
        VALUES ('Oscar', 1000)
    """

    INSERT_PREFERENCE = """
        INSERT INTO preference (fname, train, bus)
        VALUES ('Oscar', TRUE, FALSE)
    """

    db_connection = establish_db_connection()

    if db_connection:
        db_cursor = db_connection.cursor()
        try:
            db_cursor.execute(INSERT_PEOPLE)
            db_cursor.execute(INSERT_PREFERENCE)
            db_connection.commit()
            print("Tables have been populated successfully")


    else:
        print("Connection to database failed")

def test():
    db_connection = establish_db_connection()
    if db_connection:
        db_cursor = db_connection.cursor()

        arg = ('Oscar',)
        db_cursor.callproc('GetPreferences', arg)

        for result in db_cursor.stored_results():
            fetched_result = result.fetchone()

            db_cursor.close()
            close_db_connection(db_connection)

            return fetched_result


if __name__ == "__main__":
    populate_tables()

    result = test()
    if result:
        print(f"Name: {result[0]}, Train Preference: {result[1]}, Bus Preference: {result[2]}")
    else:
        print("No result found or an error occurred.")
